#!/usr/bin/env python3
"""
–û–±–Ω–æ–≤–ª—è–µ—Ç data.csv: –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã, –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ü–µ–Ω—ã,
—É–¥–∞–ª—è–µ—Ç –û—Ä–µ–æ, –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏.
"""
import csv
import re
import sys

CSV_PATH = "data.csv"

# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è name_internal (–∫–æ–ª–æ–Ω–∫–∞ 2, 0-indexed)
RENAMES = {
    "–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥": "–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1.2–∫–≥*12—à—Ç",
    "–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥": "–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1.2–∫–≥*12—à—Ç",
    "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥": "–ê–ø–µ–ª—å—Å–∏–Ω–æ–≤—ã–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç 2.6–∫–≥*8—à—Ç",
    "–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥": "–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2.6–∫–≥*8—à—Ç",
    "–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥": "–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2.6–∫–≥*8—à—Ç",
    "–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥": "–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 0.85–∫–≥*12—à—Ç",
    "–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥": "–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 0.85–∫–≥*12—à—Ç",
    "–õ–∞—Ç—Ç–µ 1 –∫–≥": "–õ–∞—Ç—Ç–µ 1–∫–≥*20—à—Ç",
    "–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥": "–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1–∫–≥*20—à—Ç",
    "–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥ ": "–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1–∫–≥*20—à—Ç",
    "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥": "–ú–∞—Ä–∞–∫—É–π—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç 2–∫–≥*6—à—Ç",
    "–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥": "–°–∏—Ä–æ–ø —Ñ—Ä—É–∫—Ç–æ–≤—ã–π 12.5–∫–≥*2—à—Ç",
    "–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥": "–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2.5–∫–≥*8—à—Ç",
    "–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥": "–¢–∞–ø–∏–æ–∫–∞ 1–∫–≥*20—à—Ç",
    "–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫": "–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ 400—à—Ç",
    "–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥": "–ú–æ—Ä–æ–∂–µ–Ω–æ–µ (—Å–ª–∏–≤–æ—á–Ω–æ–µ) 3–∫–≥*8—à—Ç",
    "–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π) 3–∫–≥": "–ú–æ—Ä–æ–∂–µ–Ω–æ–µ (—Å–ª–∏–≤–æ—á–Ω–æ–µ) 3–∫–≥*8—à—Ç",
    "–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è ( —à–æ–∫–æ–ª–∞–¥–Ω—ã–π) 3–∫–≥": "–ú–æ—Ä–æ–∂–µ–Ω–æ–µ (—à–æ–∫–æ–ª–∞–¥–Ω–æ–µ) 3–∫–≥*8—à—Ç",
    "–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π)  3–∫–≥": "–ú–æ—Ä–æ–∂–µ–Ω–æ–µ (—à–æ–∫–æ–ª–∞–¥–Ω–æ–µ) 3–∫–≥*8—à—Ç",
    "–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π) 3–∫–≥": "–ú–æ—Ä–æ–∂–µ–Ω–æ–µ (—à–æ–∫–æ–ª–∞–¥–Ω–æ–µ) 3–∫–≥*8—à—Ç",
    "–ú–∞—Ç—á–∞ –º–æ—Ä–æ–∂–µ–Ω–æ–µ": "–ú–æ—Ä–æ–∂–µ–Ω–æ–µ (–º–∞—Ç—á–∞) 3–∫–≥*8—à—Ç",
    "–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥": "–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è 3–∫–≥*8—à—Ç",
    "–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥ ": "–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è 3–∫–≥*8—à—Ç",
    "–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥": "–§—Ä—É–∫—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥*4—à—Ç",
    "–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥": "–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –ø—É–¥–∏–Ω–≥–∞ 1–∫–≥*20—à—Ç",
    "–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥": "–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2.5–∫–≥*8—à—Ç",
    "–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥": "–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2.5–∫–≥*8—à—Ç",
    "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥": "–ö–ª—É–±–Ω–∏—á–Ω—ã–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç 2–∫–≥*6—à—Ç",
    "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥": "–ß–µ—Ä–Ω–∏—á–Ω—ã–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç 2–∫–≥*6—à—Ç",
    "–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª": "–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1–ª*10—à—Ç",
    "–§–∞—Å–æ–ª—å 900 –≥": "–§–∞—Å–æ–ª—å 0.9–∫–≥*12—à—Ç",
    "–§–∞—Å–æ–ª—å 900 –≥ ": "–§–∞—Å–æ–ª—å 0.9–∫–≥*12—à—Ç",
    "–ö–∞–ø–ø—É—á–∏–Ω–æ –ø–æ—Ä–æ—à–æ–∫": "–ö–∞–ø–ø—É—á–∏–Ω–æ 1–∫–≥*20—à—Ç",
    "–ñ–∞—Å–º–∏–Ω–æ–≤—ã–π —á–∞–π": "–ñ–∞—Å–º–∏–Ω–æ–≤—ã–π —á–∞–π 50–≥*160—à—Ç",
    "–ß–µ—Ä–Ω—ã–π —á–∞–π": "–ß–µ—Ä–Ω—ã–π —á–∞–π 100–≥*120—à—Ç",
    "–°—Ç–∞–∫–∞–Ω 500": "–°—Ç–∞–∫–∞–Ω 500 (1000—à—Ç/–∫–æ—Ä)",
    "–°—Ç–∞–∫–∞–Ω 700": "–°—Ç–∞–∫–∞–Ω 700 (1000—à—Ç/–∫–æ—Ä)",
    "–°—Ç–∞–∫–∞–Ω–∞ –±–æ–ª—å—à–æ–π 900–º–ª": "–°—Ç–∞–∫–∞–Ω –±–æ–ª—å—à–æ–π 900–º–ª (200—à—Ç/–∫–æ—Ä)",
    "–°—Ç–∞–∫–∞–Ω U": "–°—Ç–∞–∫–∞–Ω U (1000—à—Ç/–∫–æ—Ä)",
    "–¢–æ–ª—Å—Ç—ã–µ –±—É–º–∞–∂–Ω—ã–µ —Ç—Ä—É–±–æ—á–∫–∏": "–¢–æ–ª—Å—Ç—ã–µ —Ç—Ä—É–±–æ—á–∫–∏ (4000—à—Ç/–∫–æ—Ä)",
    "–¢–æ–Ω–∫–∏–µ –±—É–º–∞–∂–Ω—ã–µ —Ç—Ä—É–±–æ—á–∫–∏": "–¢–æ–Ω–∫–∏–µ —Ç—Ä—É–±–æ—á–∫–∏ (5000—à—Ç/–∫–æ—Ä)",
    "–ö—Ä—ã—à–∫–∞ –∫—É–ø–æ–ª—å–Ω–∞—è 90": "–ö—Ä—ã—à–∫–∞ –∫—É–ø–æ–ª—å–Ω–∞—è (2000—à—Ç/–∫–æ—Ä)",
    "–±–æ–ª—å—à–∞—è –¥–ª–∏–Ω–Ω–∞—è –ª–æ–∂–∫–∞": "–õ–æ–∂–∫–∞ –±–æ–ª—å—à–∞—è (—á–µ—Ä–Ω–∞—è) (2000—à—Ç/–∫–æ—Ä)",
    "–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ª–æ–∂–∫–∞ (–º–∞–ª–µ–Ω—å–∫–∞—è, –¥–µ–≥—É—Å—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è)": "–õ–æ–∂–∫–∞ –º–∞–ª–µ–Ω—å–∫–∞—è (–±–µ–ª–∞—è) (1000—à—Ç/–∫–æ—Ä)",
    "–ü–ª—ë–Ω–∫–∞ –¥–ª—è –∑–∞–ø–∞–π–∫–∏ —Å—Ç–∞–∫–∞–Ω–æ–≤": "–ü–ª—ë–Ω–∫–∞ –¥–ª—è –∑–∞–ø–∞–π–∫–∏ (12—Ä—É–ª/–∫–æ—Ä)",
    "–ü–∞–∫–µ—Ç –¥–ª—è –æ–¥–Ω–æ–π —á–∞—à–∫–∏": "–ü–∞–∫–µ—Ç 1 —á–∞—à–∫–∞ (10000—à—Ç/–∫–æ—Ä)",
    "–ü–∞–∫–µ—Ç –¥–ª—è —á–µ—Ç—ã—Ä—ë—Ö —á–∞—à–µ–∫": "–ü–∞–∫–µ—Ç 4 —á–∞—à–∫–∏ (3000—à—Ç/–∫–æ—Ä)",
    "–ë—É–º–∞–∂–Ω—ã–π —Å—Ç–∞–∫–∞–Ω": "–ë—É–º–∞–∂–Ω—ã–π —Å—Ç–∞–∫–∞–Ω (500—à—Ç/–∫–æ—Ä)",
    "–ö—Ä—ã—à–∫–∞ 90 –ø–ª–∞—Å—Ç–∏–∫ –¥–ª—è –±—É–º–∞–∂–Ω–æ–≥–æ —Å—Ç–∞–∫–∞–Ω–∞": "–ö—Ä—ã—à–∫–∞ 90 –ø–ª–∞—Å—Ç–∏–∫ (1000—à—Ç/–∫–æ—Ä)",
    "–û—Ä–µ–æ –∫—Ä–æ—à–∫–∞ –¥–ª—è —Ç–æ–ø–∏–Ω–≥–∞": None,  # –£–¥–∞–ª–∏—Ç—å
}

# –¶–µ–Ω—ã: old_name_internal -> new_price_str
PRICE_UPDATES_BY_OLD_NAME = {
    "–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥": "15 500 ",
    "–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥": "25 000 ",
    "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥": "50 000 ",
    "–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥": "45 000 ",
    "–±–æ–ª—å—à–∞—è –¥–ª–∏–Ω–Ω–∞—è –ª–æ–∂–∫–∞": "30 000 ",
    "–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫": "175 000 ",
}

# –°—Ç—Ä–æ–∫–∏-–¥—É–±–ª–∏–∫–∞—Ç—ã (–ü–∞–∫–µ—Ç –¥–ª—è –¥–≤—É—Ö —á–∞—à–µ–∫ –∏–º–µ–µ—Ç —Ç–∞–∫–æ–µ –∂–µ name_internal –∫–∞–∫ –æ–¥–∏–Ω–∞—Ä–Ω—ã–π)
# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ –∫–∏—Ç–∞–π—Å–∫–æ–º—É –Ω–∞–∑–≤–∞–Ω–∏—é
RENAME_BY_CHINESE = {
    "ÂèåÊùØË¢ã": ("–ü–∞–∫–µ—Ç 2 —á–∞—à–∫–∏ (5000—à—Ç/–∫–æ—Ä)", None),
}

# –ù–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ (–¥–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω–µ—Ü, –ø–µ—Ä–µ–¥ —Ñ—É—Ç–±–æ–ª–∫–∞–º–∏)
NEW_ROWS_RAW = [
    ",Êô∂ÁêÉ –ñ–µ–ª–µ —à–∞—Ä–ª–∞—Ä—ã,–ñ–µ–ª–µ —à–∞—Ä—ã 1–∫–≥*20—à—Ç,1 –∫–≥ * 20 —É–ø./–∫–æ—Ä.,20,25 000 ,,0,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,",
    ",ÂíñÂï°Ë±Ü –ö–æ—Ñ–µ –¥”ô–Ω–¥–µ—Ä—ñ,–ö–æ—Ñ–µ –∑–µ—Ä–Ω–∞ 500–≥*20—à—Ç,\"0,5 –∫–≥ * 20 —É–ø./–∫–æ—Ä.\",10,115 000 ,,0,\"0,5\",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,",
    ",Ëõã‰ªîÁ≤â –ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –≤–∞—Ñ–µ–ª—å,–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –≤–∞—Ñ–µ–ª—å 1.5–∫–≥*8—à—Ç,\"1,5 –∫–≥ * 8 —É–ø./–∫–æ—Ä.\",12,22 000 ,,0,\"1,5\",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,",
    ",Ê§∞‰π≥ –ö–æ–∫–æ—Å–æ–≤–æ–µ –º–æ–ª–æ–∫–æ,–ö–æ–∫–æ—Å–æ–≤–æ–µ –º–æ–ª–æ–∫–æ 1–ª*12—à—Ç,1 –ª * 12 —à—Ç./–∫–æ—Ä.,12,13 500 ,,0,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,",
]


def main():
    # –ß–∏—Ç–∞–µ–º CSV –∫–∞–∫ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç—Ä–æ—á–Ω–æ (—á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
    with open(CSV_PATH, 'r', encoding='utf-8') as f:
        lines = f.readlines()

    new_lines = []
    renamed_count = 0
    price_count = 0
    deleted_count = 0
    double_bag_done = False

    for i, line in enumerate(lines):
        if i < 2:
            # –ó–∞–≥–æ–ª–æ–≤–∫–∏ ‚Äî –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
            new_lines.append(line)
            continue

        # –ü–∞—Ä—Å–∏–º —Å—Ç—Ä–æ–∫—É –∫–∞–∫ CSV –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ–ª—è–º
        parsed = list(csv.reader([line]))[0]
        if len(parsed) < 3:
            new_lines.append(line)
            continue

        name_internal = parsed[2].strip() if len(parsed) > 2 else ""
        name_chinese = parsed[0].strip() if len(parsed) > 0 else ""

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–¥–∞–ª–µ–Ω–∏–µ (–û—Ä–µ–æ)
        if name_internal in RENAMES and RENAMES[name_internal] is None:
            print(f"üóëÔ∏è  –£–¥–∞–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞ {i+1}: {name_internal}")
            deleted_count += 1
            continue

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞–∫–µ—Ç –¥–ª—è –¥–≤—É—Ö —á–∞—à–µ–∫ –ø–æ –∫–∏—Ç–∞–π—Å–∫–æ–º—É –Ω–∞–∑–≤–∞–Ω–∏—é
        matched_chinese = False
        for cn_key, (new_name, _) in RENAME_BY_CHINESE.items():
            if cn_key in name_chinese and not double_bag_done:
                line = line.replace(name_internal, new_name, 1)
                print(f"‚úÖ –°—Ç—Ä–æ–∫–∞ {i+1}: {name_internal} ‚Üí {new_name} (–ø–æ –∫–∏—Ç. –∏–º–µ–Ω–∏)")
                renamed_count += 1
                double_bag_done = True
                matched_chinese = True
                break

        if not matched_chinese and name_internal in RENAMES:
            new_name = RENAMES[name_internal]
            if new_name:
                line = line.replace(name_internal, new_name, 1)
                print(f"‚úÖ –°—Ç—Ä–æ–∫–∞ {i+1}: {name_internal} ‚Üí {new_name}")
                renamed_count += 1

        # –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–Ω—É
        if name_internal in PRICE_UPDATES_BY_OLD_NAME:
            new_price_str = PRICE_UPDATES_BY_OLD_NAME[name_internal]
            # –¶–µ–Ω–∞ –≤ –∫–æ–ª–æ–Ω–∫–µ 5. –ó–∞–º–µ–Ω—è–µ–º –≤ CSV
            parsed_new = list(csv.reader([line]))[0]
            if len(parsed_new) > 5:
                old_price = parsed[5]
                if old_price.strip() != new_price_str.strip():
                    line = line.replace(old_price, new_price_str, 1)
                    print(f"üí∞ –°—Ç—Ä–æ–∫–∞ {i+1}: —Ü–µ–Ω–∞ {old_price.strip()} ‚Üí {new_price_str.strip()}")
                    price_count += 1

        new_lines.append(line)

    # –í—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–µ—Ä–µ–¥ —Ñ—É—Ç–±–æ–ª–∫–∞–º–∏ (—Å—Ç—Ä–æ–∫–∞ 48 –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª–µ)
    # –ò—â–µ–º —Å—Ç—Ä–æ–∫—É —Å "Â§èË£ÖT-shirt"
    insert_index = len(new_lines)
    for j, line in enumerate(new_lines):
        if "Â§èË£ÖT-shirt" in line or "–®—Ç." in line:
            insert_index = j
            break

    for raw_line in NEW_ROWS_RAW:
        new_lines.insert(insert_index, raw_line + "\n")
        print(f"‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ç—Ä–æ–∫–∞: {raw_line[:60]}...")
        insert_index += 1

    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
    with open(CSV_PATH, 'w', encoding='utf-8') as f:
        f.writelines(new_lines)

    print(f"\nüìä –ò—Ç–æ–≥–æ: –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ {renamed_count}, —Ü–µ–Ω –æ–±–Ω–æ–≤–ª–µ–Ω–æ {price_count}, "
          f"—É–¥–∞–ª–µ–Ω–æ {deleted_count}, –¥–æ–±–∞–≤–ª–µ–Ω–æ {len(NEW_ROWS_RAW)}")


if __name__ == '__main__':
    main()
