#!/usr/bin/env python3
"""
–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - –æ—Å—Ç–∞—Ç–∫–∏ –∏ –ø–æ—Å—Ç–∞–≤–∫–∏
"""
import asyncio
import os
from datetime import datetime
from database_pg import DatabasePG
from dotenv import load_dotenv

load_dotenv()

# –ú–∞–ø–ø–∏–Ω–≥ –Ω–∞–∑–≤–∞–Ω–∏–π –∏–∑ –∑–∞–º–µ—Ç–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí –Ω–∞–∑–≤–∞–Ω–∏—è –≤ –ë–î
NAME_MAPPING = {
    "–º–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥": "–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥",
    "–ø–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥": "–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥",
    "–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥": "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥",
    "–º–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥": "–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥",
    "–≤–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥": "–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥",
    "–≤–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥": "–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥",
    "–≥—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥": "–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥",
    "–ª–∞—Ç—Ç–µ 1 –∫–≥": "–õ–∞—Ç—Ç–µ 1 –∫–≥",
    "—è–Ω—á–∂–∏ –≥–∞–Ω–ª—É 1 –∫–≥": "–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥",
    "–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥": "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥",
    "—Å–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥": "–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥",
    "–∫–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥": "–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥",
    "—Ç–∞–ø–∏–æ–∫–∞ 1 –∫–≥": "–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥",
    "—Ö—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫": "–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫",
    "–ø–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π) 3 –∫–≥": "–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥",
    "–ø–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π) 3 –∫–≥": "–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π)  3–∫–≥",
    "—à–æ–∫–æ–ª–∞–¥–Ω–æ–µ –º–æ—Ä–æ–∂–µ–Ω–æ–µ 3 –∫–≥": "–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π)  3–∫–≥",
    "–∫–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥": "–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥",
    "—Ñ—Ä—É—Ç–æ–≤—ã–π –º—ë–¥ 5,5 –∫–≥": "–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥",
    "–ø–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥": "–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥",
    "—á—ë—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥": "–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥",
    "—à–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥": "–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥",
    "–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥": "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥",
    "–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥": "–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥",
    "–ø–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª": "–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª",
    "—Ñ–∞—Å–æ–ª—å 900 –≥": "–§–∞—Å–æ–ª—å 900 –≥",
}

# –û–°–¢–ê–¢–ö–ò –ü–û –î–ê–¢–ê–ú
STOCK_DATA = {
    "2024-11-17": [
        ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 17),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 40),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 4),
        ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 4),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 4),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 22),
        ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 7),
        ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 16),
        ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 13),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 18),
        ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 7),
        ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 17),
        ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 67),
        ("–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫", 13),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 22),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π)  3–∫–≥", 32),
        ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 3),
        ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 13),
        ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 19),
        ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 3),
        ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 4),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 7),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 7),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 15),
        ("–§–∞—Å–æ–ª—å 900 –≥", 30),
    ],
    "2024-11-19": [
        ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 16),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 39),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 3),
        ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 3),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 4),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 18),
        ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 6),
        ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 14),
        ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 13),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 13),
        ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 6),
        ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 5),
        ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 53),
        ("–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫", 12.5),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 18),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π)  3–∫–≥", 28),
        ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 2),
        ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 11),
        ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 19),
        ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 3),
        ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 4),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 7),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 7),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 15),
        ("–§–∞—Å–æ–ª—å 900 –≥", 30),
    ],
    "2024-11-20": [
        ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 15),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 38),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 18),
        ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 2),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 18),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 17),
        ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 5),
        ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 14),
        ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 11.5),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 10),
        ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 6),
        ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 0),
        ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 48),
        ("–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫", 11),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 56),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π)  3–∫–≥", 26),
        ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 0),
        ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 10),
        ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 19),
        ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 3),
        ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 4),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 19),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 19),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 15),
        ("–§–∞—Å–æ–ª—å 900 –≥", 30),
    ],
    "2024-11-22": [
        ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 12),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 32),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 24),
        ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 9),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 26),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 16),
        ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 15),
        ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 12),
        ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 10),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 8),
        ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 10),
        ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 0),
        ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 118),
        ("–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫", 10.5),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 46),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π)  3–∫–≥", 17),
        ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 38),
        ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 20),
        ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 16),
        ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 11),
        ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 3),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 22),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 23),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 15),
        ("–§–∞—Å–æ–ª—å 900 –≥", 35),
    ],
    "2024-11-23": [
        ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 11),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 32),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 23),
        ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 9),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 26),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 13),
        ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 15),
        ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 11),
        ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 8),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 5),
        ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 10),
        ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 0),
        ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 114),
        ("–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫", 9.5),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 38),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π)  3–∫–≥", 11),
        ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 38),
        ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 18),
        ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 18),
        ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 11),
        ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 1),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 20),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 22),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 15),
        ("–§–∞—Å–æ–ª—å 900 –≥", 33),
    ],
    "2024-11-30": [
        ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 3),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 36),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 19),
        ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 4),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 24),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 0),
        ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 10),
        ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 7),
        ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 20),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 29),
        ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 9),
        ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 79),
        ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 77),
        ("–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫", 5),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 0),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π)  3–∫–≥", 0),
        ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 25),
        ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 9),
        ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 15),
        ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 5),
        ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 0),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 11),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 18),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 13),
        ("–§–∞—Å–æ–ª—å 900 –≥", 38),
    ],
    "2024-12-01": [
        ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 13),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 37),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 16),
        ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 3),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 23),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 0),
        ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 9),
        ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 6),
        ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 20),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 23),
        ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 9),
        ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 73),
        ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 70),
        ("–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ –ø–æ 400 —à—Ç—É–∫", 5),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 0),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—à–æ–∫–æ–ª–∞–¥–Ω—ã–π)  3–∫–≥", 0),
        ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 22),
        ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 8),
        ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 17),
        ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 4),
        ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 0),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 11),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 17),
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 12),
        ("–§–∞—Å–æ–ª—å 900 –≥", 37),
    ],
}

# –ü–û–°–¢–ê–í–ö–ò (—Ç–æ–ª—å–∫–æ —Ç–æ–≤–∞—Ä—ã –≥–¥–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ > 0)
SUPPLIES_DATA = {
    "2024-11-19": [
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 16),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 16),
        ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 40),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 12),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 12),
    ],
    "2024-11-21": [
        ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 12),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 8),
        ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 8),
        ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 8),
        ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 12),
        ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 4),
        ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 80),
        ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 40),
        ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 12),
        ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 8),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 6),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 6),
        ("–§–∞—Å–æ–ª—å 900 –≥", 12),
    ],
    "2024-11-29": [
        ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 14.4),
        ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 20),
        ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 60),
        ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 200),
        ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 21.6),
    ],
}


async def main():
    """–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö"""
    database_url = os.getenv('DATABASE_URL')
    if not database_url:
        print("‚ùå ERROR: DATABASE_URL –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω")
        return

    db = DatabasePG(database_url)
    await db.init_db()
    print("‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ PostgreSQL\n")

    # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
    products = await db.get_all_products()
    product_map = {}
    for product in products:
        key = product['name_internal'].lower().strip()
        product_map[key] = product

    print(f"üì¶ –ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –ë–î: {len(products)}\n")

    # ========== –ò–ú–ü–û–†–¢ –û–°–¢–ê–¢–ö–û–í ==========
    print("=" * 70)
    print("üìä –ò–ú–ü–û–†–¢ –û–°–¢–ê–¢–ö–û–í")
    print("=" * 70)

    stock_imported = 0
    stock_updated = 0
    stock_skipped = 0

    for date_str, items in STOCK_DATA.items():
        date_obj = datetime.strptime(date_str, '%Y-%m-%d').date()
        print(f"\nüìÖ {date_obj.strftime('%d.%m.%Y')}:")

        for product_name, quantity in items:
            key = product_name.lower().strip()
            product = product_map.get(key)

            if not product:
                print(f"   ‚ö†Ô∏è  –¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω: '{product_name}'")
                stock_skipped += 1
                continue

            weight = quantity * product['package_weight']

            try:
                await db.add_stock(
                    product_id=product['id'],
                    date=date_obj,
                    quantity=quantity,
                    weight=weight
                )
                print(f"   ‚úÖ {product_name}: {quantity} —É–ø.")
                stock_updated += 1
            except Exception as e:
                print(f"   ‚ùå –û—à–∏–±–∫–∞: {product_name}: {e}")
                stock_skipped += 1

    print(f"\n{'=' * 70}")
    print(f"–û—Å—Ç–∞—Ç–∫–∏: –æ–±–Ω–æ–≤–ª–µ–Ω–æ {stock_updated}, –ø—Ä–æ–ø—É—â–µ–Ω–æ {stock_skipped}")
    print("=" * 70)

    # ========== –ò–ú–ü–û–†–¢ –ü–û–°–¢–ê–í–û–ö ==========
    print("\n" + "=" * 70)
    print("üì¶ –ò–ú–ü–û–†–¢ –ü–û–°–¢–ê–í–û–ö")
    print("=" * 70)

    supply_imported = 0
    supply_skipped = 0

    for date_str, items in SUPPLIES_DATA.items():
        date_obj = datetime.strptime(date_str, '%Y-%m-%d').date()
        print(f"\nüìÖ {date_obj.strftime('%d.%m.%Y')}:")

        for product_name, boxes in items:
            key = product_name.lower().strip()
            product = product_map.get(key)

            if not product:
                print(f"   ‚ö†Ô∏è  –¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω: '{product_name}'")
                supply_skipped += 1
                continue

            weight = boxes * product['box_weight']
            cost = boxes * product['price_per_box']

            try:
                await db.add_supply(
                    product_id=product['id'],
                    date=date_obj,
                    boxes=boxes,
                    weight=weight,
                    cost=cost
                )
                print(f"   ‚úÖ {product_name}: {boxes} –∫–æ—Ä. ({weight:.1f} {product['unit']}, {cost:,.0f}‚Ç∏)")
                supply_imported += 1
            except Exception as e:
                print(f"   ‚ùå –û—à–∏–±–∫–∞: {product_name}: {e}")
                supply_skipped += 1

    print(f"\n{'=' * 70}")
    print(f"–ü–æ—Å—Ç–∞–≤–∫–∏: –¥–æ–±–∞–≤–ª–µ–Ω–æ {supply_imported}, –ø—Ä–æ–ø—É—â–µ–Ω–æ {supply_skipped}")
    print("=" * 70)

    await db.close()

    print("\n" + "=" * 70)
    print("‚úÖ –ò–ú–ü–û–†–¢ –ó–ê–í–ï–†–®–ï–ù!")
    print("=" * 70)
    print(f"\nüìä –ò—Ç–æ–≥–æ:")
    print(f"   –û—Å—Ç–∞—Ç–∫–∏: –æ–±–Ω–æ–≤–ª–µ–Ω–æ {stock_updated} –∑–∞–ø–∏—Å–µ–π")
    print(f"   –ü–æ—Å—Ç–∞–≤–∫–∏: –¥–æ–±–∞–≤–ª–µ–Ω–æ {supply_imported} –∑–∞–ø–∏—Å–µ–π")
    print(f"\nüí° –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ –±–æ—Ç–µ: /verify_data")


if __name__ == '__main__':
    asyncio.run(main())
