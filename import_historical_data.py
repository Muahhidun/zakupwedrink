"""
–ò–º–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
"""
import asyncio
import os
import re
from datetime import datetime
from database_pg import DatabasePG
from dotenv import load_dotenv

load_dotenv()


async def main():
    database_url = os.getenv('DATABASE_URL')
    if not database_url:
        print("‚ùå DATABASE_URL –Ω–µ –Ω–∞–π–¥–µ–Ω")
        return

    db = DatabasePG(database_url)
    await db.init_db()

    try:
        # –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —Ç–æ–≤–∞—Ä—ã
        products = await db.get_all_products()
        print(f"üì¶ –ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –ë–î: {len(products)}")

        # –°–æ–∑–¥–∞–µ–º –º–∞–ø–ø–∏–Ω–≥ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
        product_map = {}
        for p in products:
            # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞
            key = p['name_internal'].lower().replace(' ', '').replace('—ë', '–µ')
            product_map[key] = p

        print("\nüîÑ –ò–º–ø–æ—Ä—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø–æ –¥–∞—Ç–∞–º...")

        # –û—Å—Ç–∞—Ç–∫–∏ –ø–æ –¥–∞—Ç–∞–º
        stock_data = [
            ("2024-11-17", [
                ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 17), ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 40),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 4),
                ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 4), ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 4),
                ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 22), ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 7),
                ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 16), ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 13),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 18),
                ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 7),
                ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 17), ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 67),
                ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 22),
                ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 19),
                ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 3), ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 4),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 7),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 7),
                ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 15),
            ]),
            ("2024-11-19", [
                ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 16), ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 39),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 3),
                ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 3), ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 4),
                ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 18), ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 6),
                ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 14), ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 13),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 13),
                ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 6),
                ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 5), ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 53),
                ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 18),
                ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 19),
                ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 3), ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 4),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 7),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 7),
                ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 15),
            ]),
            ("2024-11-20", [
                ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 15), ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 38),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 18),
                ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 2), ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 18),
                ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 17), ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 5),
                ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 14), ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 11.5),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 10),
                ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 6),
                ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 0), ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 48),
                ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 56),
                ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 19),
                ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 3), ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 4),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 19),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 19),
                ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 15),
            ]),
            ("2024-11-22", [
                ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 12), ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 32),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 24),
                ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 9), ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 26),
                ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 16), ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 15),
                ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 12), ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 10),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 8),
                ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 10),
                ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 0), ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 118),
                ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 46),
                ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 38),
                ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 20),
                ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 16),
                ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 11), ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 3),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 22),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 23),
                ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 15),
            ]),
            ("2024-11-23", [
                ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 11), ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 32),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 23),
                ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 9), ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 26),
                ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 13), ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 15),
                ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 11), ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 8),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 5),
                ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 10),
                ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 0), ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 114),
                ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 38),
                ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 38),
                ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 18),
                ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 18),
                ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 11), ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 1),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 20),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 22),
                ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 15),
            ]),
            ("2024-11-30", [
                ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 3), ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 36),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 19),
                ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 4), ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 24),
                ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 0), ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 10),
                ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 7), ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 20),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 29),
                ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 9),
                ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 79), ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 77),
                ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 0),
                ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 25),
                ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 9),
                ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 15),
                ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 5), ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 0),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 11),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 18),
                ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 13),
            ]),
            ("2024-12-01", [
                ("–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 13), ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1,2 –∫–≥", 37),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ –∞–ø–µ–ª—å—Å–∏–Ω–∞ 2,6 –∫–≥", 16),
                ("–ú–∞–ª–∏–Ω–∞ —Å–æ–∫ 2,6 –∫–≥", 3), ("–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2,6 –∫–≥", 23),
                ("–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 850 –≥", 0), ("–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 850 –≥", 9),
                ("–õ–∞—Ç—Ç–µ 1 –∫–≥", 6), ("–Ø–Ω—á–∂–∏ –ì–∞–Ω–ª—É 1 –∫–≥", 20),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç —Å–æ–∫–∞ –º–∞—Ä–∞–∫—É–π–∏ 2 –∫–≥", 23),
                ("–°–∏—Ä–æ–ø –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤–æ–≥–æ —Å–æ–∫–∞ 12,5 –∫–≥", 9),
                ("–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2,5 –∫–≥", 73), ("–¢–∞–ø–∏–æ–∫–∞ 1 –∫–≥", 70),
                ("–ü–æ—Ä–æ—à–æ–∫ —Å–æ –≤–∫—É—Å–æ–º –º–æ–ª–æ—á–Ω–æ–≥–æ –∫–æ–∫—Ç–µ–π–ª—è (—Å–ª–∏–≤–æ—á–Ω—ã–π)  3–∫–≥", 0),
                ("–ö–æ–º–ø–∞–Ω—å–æ–Ω –¥–ª—è —á–∞—è —Å –º–æ–ª–æ–∫–æ–º 3 –∫–≥", 22),
                ("–§—Ä—É—Ç–æ–≤—ã–π –º–µ–¥ 5.5–∫–≥", 8),
                ("–ü–æ—Ä–æ—à–æ–∫ –¥–ª—è –∫–∞—Ä–∞–º–µ–ª—å–Ω–æ–≥–æ –ø—É–¥–∏–Ω–≥–∞ 1 –∫–≥", 17),
                ("–ß–µ—Ä–Ω—ã–π —Å–∞—Ö–∞—Ä 2,5 –∫–≥", 4), ("–®–æ–∫–æ–ª–∞–¥–Ω—ã–π —Å–∏—Ä–æ–ø 2,5 –∫–≥", 0),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –∫–ª—É–±–Ω–∏—á–Ω–æ–≥–æ —Å–æ–∫–∞ 2 –∫–≥", 11),
                ("–ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç –Ω–∞–ø–∏—Ç–∫–∞ —Å –∫—É—Å–æ—á–∫–∞–º–∏ —á–µ—Ä–Ω–∏–∫–∏ 2 –∫–≥", 17),
                ("–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –∂–µ–ª–µ 1 –ª", 12),
            ]),
        ]

        total_imported = 0
        for date_str, items in stock_data:
            # –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç—Ä–æ–∫—É –¥–∞—Ç—ã –≤ datetime.date
            date_obj = datetime.strptime(date_str, '%Y-%m-%d').date()
            print(f"\nüìÖ {date_str}")
            for name, qty in items:
                # –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ
                key = name.lower().replace(' ', '').replace('—ë', '–µ')
                product = product_map.get(key)

                if product:
                    weight = qty * product['package_weight']
                    try:
                        await db.add_stock(
                            product_id=product['id'],
                            date=date_obj,
                            quantity=qty,
                            weight=weight
                        )
                        total_imported += 1
                    except Exception as e:
                        print(f"   ‚ö†Ô∏è  –û—à–∏–±–∫–∞ {name}: {e}")
                else:
                    print(f"   ‚ö†Ô∏è  –ù–µ –Ω–∞–π–¥–µ–Ω: {name}")

        print(f"\n‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –æ—Å—Ç–∞—Ç–∫–æ–≤: {total_imported}")

    finally:
        await db.close()


if __name__ == '__main__':
    asyncio.run(main())
