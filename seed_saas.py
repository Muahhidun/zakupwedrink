import asyncio
import asyncpg
import sys
import os

DATABASE_URL = "postgresql://postgres:IfdxbfvVzYJDioOgXLDyJVUsgyXbDCHf@yamabiko.proxy.rlwy.net:24013/railway"

# –°–ø–∏—Å–æ–∫ –±–∞–∑–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ WeDrink
PRODUCTS = [
    # –ò–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã
    ("ËäíÊûúÊ≥•", "–ú–∞–Ω–≥–æ –ø—é—Ä–µ—Å—ñ", "–ú–∞–Ω–≥–æ–≤–æ–µ –ø—é—Ä–µ 1.2–∫–≥*12—à—Ç", 1.2, 12, 36000.0, "–∫–≥"),
    ("Ê°ÉÊ≥•", "–®–∞–±–¥–∞–ª—ã –ø—é—Ä–µ—Å—ñ", "–ü–µ—Ä—Å–∏–∫–æ–≤–æ–µ –ø—é—Ä–µ 1.2–∫–≥*12—à—Ç", 1.2, 12, 36000.0, "–∫–≥"),
    ("Ê©ôÊ±Å", "–ê–ø–µ–ª—å—Å–∏–Ω –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç—ã", "–ê–ø–µ–ª—å—Å–∏–Ω–æ–≤—ã–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç 2.6–∫–≥*8—à—Ç", 2.6, 8, 50000.0, "–∫–≥"),
    ("Ëë°ËêÑÊ±Å", "–ñ“Ø–∑—ñ–º —à—ã—Ä—ã–Ω—ã", "–í–∏–Ω–æ–≥—Ä–∞–¥–Ω—ã–π —Å–æ–∫ 2.6–∫–≥*8—à—Ç", 2.6, 8, 45000.0, "–∫–≥"),
    ("ÁΩêË£ÖËë°ËêÑ", "–ö–æ–Ω—Å–µ—Ä–≤—ñ–ª–µ–Ω–≥–µ–Ω –∂“Ø–∑—ñ–º", "–í–∏–Ω–æ–≥—Ä–∞–¥ –∫–æ–Ω—Å–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–π 0.85–∫–≥*12—à—Ç", 0.85, 12, 28000.0, "–∫–≥"),
    ("Ëë°ËêÑÊüö", "–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç", "–ì—Ä–µ–π–ø—Ñ—Ä—É—Ç 0.85–∫–≥*12—à—Ç", 0.85, 12, 26000.0, "–∫–≥"),
    ("ÊãøÈìÅ", "–õ–∞—Ç—Ç–µ", "–õ–∞—Ç—Ç–µ 1–∫–≥*20—à—Ç", 1.0, 20, 60000.0, "–∫–≥"),
    ("ÁôæÈ¶ôÊûúÊ±Å", "–ú–∞—Ä–∞–∫—É–π—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç—ã", "–ú–∞—Ä–∞–∫—É–π—è –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ç 2–∫–≥*6—à—Ç", 2.0, 6, 38000.0, "–∫–≥"),
    ("Ê§∞Ëìâ", "–ö–æ–∫–æ—Å “Ø–≥—ñ–Ω–¥—ñ—Å—ñ", "–ö–æ–∫–æ—Å–æ–≤—ã–µ –∫—É—Å–æ—á–∫–∏ 2.5–∫–≥*8—à—Ç", 2.5, 8, 15500.0, "–∫–≥"),
    ("Êú®ËñØÁ≤â", "–¢–∞–ø–∏–æ–∫–∞", "–¢–∞–ø–∏–æ–∫–∞ 1–∫–≥*20—à—Ç", 1.0, 20, 25000.0, "–∫–≥"),
    ("ËõãÂç∑Á≠í", "–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏", "–•—Ä—É—Å—Ç—è—â–∏–µ —Ä–æ–∂–∫–∏ 400—à—Ç", 0.5, 16, 10937.5, "—à—Ç"),
    ("Â•∂ÊòîÁ≤â(Â∑ßÂÖãÂäõ)", "–ë–∞–ª–º“±–∑–¥–∞“õ (—à–æ–∫–æ–ª–∞–¥—Ç—ã)", "–ú–æ—Ä–æ–∂–µ–Ω–æ–µ (—à–æ–∫–æ–ª–∞–¥–Ω–æ–µ) 3–∫–≥*8—à—Ç", 3.0, 8, 71250.0, "–∫–≥"),
    ("Âç°Â∏ÉÂ•áËØ∫", "–ö–∞–ø—É—á–∏–Ω–æ", "–ö–∞–ø–ø—É—á–∏–Ω–æ 1–∫–≥*20—à—Ç", 1.0, 20, 52000.0, "–∫–≥"),
    ("ËåâËéâËä±Ëå∂", "–ñ–∞—Å–º–∏–Ω —à–∞–π—ã", "–ñ–∞—Å–º–∏–Ω–æ–≤—ã–π —á–∞–π 50–≥*160—à—Ç", 0.05, 160, 28000.0, "–∫–≥"),
    # –£–ø–∞–∫–æ–≤–∫–∞
    ("500mlÊùØ", "–°—Ç–∞–∫–∞–Ω 500–º–ª", "–°—Ç–∞–∫–∞–Ω 500 (1000—à—Ç/–∫–æ—Ä)", 0.02, 1000, 22000.0, "—à—Ç"),
    ("700mlÊùØ", "–°—Ç–∞–∫–∞–Ω 700–º–ª", "–°—Ç–∞–∫–∞–Ω 700 (1000—à—Ç/–∫–æ—Ä)", 0.025, 1000, 24000.0, "—à—Ç"),
    ("Á≤óÁ∫∏Âê∏ÁÆ°", "–ñ—É–∞–Ω “õ–∞“ì–∞–∑ —Å–∞–±–∞–Ω", "–¢–æ–ª—Å—Ç—ã–µ —Ç—Ä—É–±–æ—á–∫–∏ (4000—à—Ç/–∫–æ—Ä)", 0.005, 4000, 12000.0, "—à—Ç"),
    ("ÂúÜÈ°∂Áõñ90", "–ö“Ø–º–±–µ–∑ “õ–∞“õ–ø–∞“õ", "–ö—Ä—ã—à–∫–∞ –∫—É–ø–æ–ª—å–Ω–∞—è (2000—à—Ç/–∫–æ—Ä)", 0.01, 2000, 14000.0, "—à—Ç"),
]

async def seed_saas():
    company_id = 1
    print(f"Connecting to Staging Database to seed products for Company ID: {company_id}...")
    try:
        conn = await asyncpg.connect(DATABASE_URL)
        
        added = 0
        for (nc, nr, ni, pw, upb, ppb, unit) in PRODUCTS:
            box_weight = pw * upb
            try:
                await conn.execute("""
                    INSERT INTO products
                    (company_id, name_chinese, name_russian, name_internal, package_weight,
                     units_per_box, box_weight, price_per_box, unit)
                    VALUES ($1, $2, $3, $4, $5, $6, $7, $8, $9)
                    ON CONFLICT DO NOTHING
                """, company_id, nc, nr, ni, pw, upb, box_weight, ppb, unit)
                added += 1
                print(f"  ‚úÖ {ni}")
            except Exception as e:
                print(f"Error adding {ni}: {e}")
                
        print(f"\nüì¶ –£—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ {added} –±–∞–∑–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è Company 1.")
        await conn.close()
    except Exception as e:
        print(f"‚ùå Error: {e}")

if __name__ == "__main__":
    asyncio.run(seed_saas())
